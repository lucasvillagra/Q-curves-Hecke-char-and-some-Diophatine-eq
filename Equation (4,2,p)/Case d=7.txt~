load "Koutsianas.mg"
load "mazur42p.mg"

/* Koutsianas script */

chi:=Generators(DirichletGroup(7))[1];
Koutsianas(chi);

/* Discarding newforms */


/* Character chi */

Chi:= function(p)
f:=order(KroneckerSymbol(-1,p)*KroneckerSymbol(p,2)*KroneckerSymbol(p,7));
if KroneckerSymbol(-5,p) eq 1 then
   f:=2;
end if;
return f;
end function;

/* First space */

G:=DirichletGroup(2*7^2);
eps:=Elements(G)[1];
M:=ModularSymbols(eps,2,1);
S:=NewSubspace(CuspidalSubspace(M));
new:=NewformDecomposition(S);
CM:=FormsWithCM(new);


/* Mazur's trick for forms without CM */

for i in [1..#new] do
if i notin CM then
print(DiscardPlace(7,eps,Chi,new,i,1,50));
end if;
end for;

/* Second space */

G:=DirichletGroup(2^8*7^2);
eps:=Elements(G)[1];
M:=ModularSymbols(eps,2,1);
S:=NewSubspace(CuspidalSubspace(M));
new:=NewformDecomposition(S);
CM:=FormsWithCM(new);

/* Mazur's trick for forms without CM */

for i in [1..#new] do
if i notin CM then
print(DiscardPlace(7,eps,Chi,new,i,1,20));
end if;
end for;

